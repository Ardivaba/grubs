@namespace Grubs.UI

@inherits PanelComponent

@attribute [StyleSheet]

<root>
    <img src=@Icon />
</root>

@code {
    public GameObject Target { get; set; }
    public string Icon { get; set; }

    [Property] private float RiseSpeed { get; set; } = 7.5f;
    [Property] private float DestroyDelay { get; set; } = 3f;

    private Vector3 _offset = Vector3.Up * 64f;

    protected override void OnStart()
    {
        _ = DelayDestroy();
    }

    protected override void OnUpdate()
    {
        _offset += Vector3.Up * RiseSpeed * Time.Delta;
        UpdatePosition();
    }

    protected override int BuildHash() => HashCode.Combine(Icon);

    private void UpdatePosition() => Transform.Position = Target.Transform.Position + _offset;

    private async Task DelayDestroy()
    {
        int ms = (int)(DestroyDelay * 1000);
        await GameTask.Delay(ms);

        GameObject.Destroy();
    }
}